<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="keywords" content="SPARKE, Diversity, Diffusion Models, RKE Score, Vendi Score, Diversity Guidance, Generative Models, Machine Learning, AI Research">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SPARKE: Scalable Prompt-Aware Diversity Guidance in Diffusion Models via RKE Score</title>
<meta name="description" content="SPARKE is a novel diversity guidance method for diffusion models that enhances output diversity without sacrificing quality.">
<meta name="author" content="Mohammad Jalali">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://mjalali.github.io/SPARKE/">

<!-- Open Graph -->
<meta property="og:title" content="SPARKE: Scalable Prompt-Aware Diversity Guidance in Diffusion Models via RKE Score">
<meta property="og:description" content="SPARKE is a novel diversity guidance method for diffusion models that enhances output diversity without sacrificing quality.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://mjalali.github.io/SPARKE/">
<meta property="og:image" content="https://mjalali.github.io/SPARKE/static/images/sparke_overview.webp">
<meta property="og:image:alt" content="SPARKE Overview">
<meta property="og:site_name" content="SPARKE: Diffusion Model Diversity Guidance">

<!-- Twitter Card -->
<meta name="twitter:title" content="SPARKE: Scalable Prompt-Aware Diversity Guidance in Diffusion Models via RKE Score">
<meta name="twitter:description" content="SPARKE is a novel diversity guidance method for diffusion models that enhances output diversity without sacrificing quality.">
<meta name="twitter:image" content="https://mjalali.github.io/SPARKE/static/images/sparke_overview.webp">

<meta property="og:image" content="https://mjalali.github.io/SPARKE/static/images/sparke_overview_linkedin.jpg">
<meta property="og:image:type" content="image/jpeg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">


<!-- Mobile & Verification -->
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="google-site-verification" content="xMHDE6Ljiod7PoRSLLiGs1coM6j1U_bVS5GSoWCGj9Q" />
<meta property="article:published_time" content="2025-06-26T00:00:00Z" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9K0S5B8YBD"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-9K0S5B8YBD');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!-- Standard favicon -->
<link rel="icon" href="./static/images/favicon.ico" type="image/x-icon" />
<link rel="icon" type="image/png" sizes="32x32" href="./static/images/favicon-32x32.png" />
<link rel="icon" type="image/svg+xml" href="./favicon.svg" />
<link rel="apple-touch-icon" sizes="180x180" href="./favicon-32x32.png" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://mjalali.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://arxiv.org/abs/2411.02817">
            Conditional Vendi Score
          </a>
          <a class="navbar-item" href="https://github.com/mjalali/renyi-kernel-entropy">
            RKE Score
          </a>
        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">
            ✨ <span class="sparke-gradient">SPARKE</span>: Scalable Prompt-Aware Diversity Guidance in Diffusion Models via RKE Score
          </h1>
          
          <!-- <h1 class="title is-1 publication-title">✨ <span class="sparke-gradient">SPARKE</span> : Scalable Prompt-Aware Diversity Guidance in Diffusion Models via RKE Score</h1> -->
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://mjalali.github.io">Mohammad Jalali</a><sup>*</sup>,</span>
            <span class="author-block">
              <a href="https://openreview.net/profile?id=~Haoyu_LEI1">Haoyu Lei</a><sup>*</sup>,</span>
            <span class="author-block">
              <a href="https://www.ie.cuhk.edu.hk/faculty/gohari-amin/">Amin Gohari</a>,
            </span>
            <span class="author-block">
              <a href="https://www.cse.cuhk.edu.hk/~farnia/">Farzan Farnia</a>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">The Chinese University of Hong Kong</span>
            <!-- <span class="author-block"><sup>2</sup>Department of Information Engineering, The Chinese University of Hong Kong</span> -->
          </div>
          <div class="is-size-6 publication-authors">
            <span class="author-block"><sup>*</sup>Equal contribution</span>
          </div>
          <div class="is-size-4 is-centered publication-venue">
            <span class="sparke-gradient">Accepted at NeurIPS 2025</span>
          </div>


          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2506.10173"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2506.10173"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a> -->
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/mjalali/sparke-guidance"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Github Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://colab.research.google.com/drive/1bKAIEsm2GQPKMFXUPUd6iCoS1TWkZqnn?usp=sharing"
                class="external-link button is-normal is-rounded is-dark"
                target="_blank" rel="noopener noreferrer">
               <span class="icon">
                 <img src="https://img.icons8.com/?size=100&id=lOqoeP2Zy02f&format=png&color=000000"
                      alt="Colab" style="height: 1em; width: 1em; vertical-align: middle;">
               </span>
               <span>Quick Start (Colab)</span>
               </a>
              </span>
              <span class="link-block">
                <a href="#bibtex"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-obp"></i>
                  </span>
                  <span>BibTex</span>
                </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video poster="" id="teaser" autoplay controls muted loop playsinline height="100%">
        <source src="./static/videos/pixart.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">SPARKE</span> improves the diversity of diffusion models with high computational efficiency.
      </h2>
    </div>
  </div>
</section>

<section class="section hero is-light">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Diffusion models have demonstrated remarkable success in high-fidelity image synthesis and prompt-guided generative modeling. 
            However, ensuring adequate diversity in generated samples of prompt-guided diffusion models remains a challenge, 
            particularly when the prompts span a broad semantic spectrum and the diversity of generated data needs to be evaluated in a
            prompt-aware fashion across semantically similar prompts. Recent methods have introduced guidance via diversity measures to encourage more varied generations. 
           </p>
           <p>
            We extend the diversity measure-based approaches by proposing the
            <em><u><strong>S</strong></u>calable <u><strong>P</strong></u>rompt-<u><strong>A</strong></u>ware <u><strong>R</strong></u>enyi <u><strong>K</strong></u>ernel
            <u><strong>E</strong></u>ntropy Diversity Guidance</em> (<strong>SPARKE</strong>) method for prompt-aware diversity guidance.
            SPARKE utilizes conditional entropy for diversity guidance, which dynamically conditions diversity measurement on similar prompts and enables prompt-aware diversity control.
            While the entropy-based guidance approach enhances prompt-aware diversity, its reliance on the matrix-based entropy scores poses computational challenges in large-scale generation settings.
            To address this, we focus on the special case of <em>Conditional latent RKE Score Guidance</em>, reducing entropy computation and gradient-based optimization complexity from
            <code>𝒪(n³)</code> of general entropy measures to <code>𝒪(n)</code>. The reduced computational complexity allows for diversity-guided sampling over potentially thousands of generation rounds on different prompts.
            We numerically test the SPARKE method on several text-to-image diffusion models, demonstrating that the proposed method improves the prompt-aware diversity of the generated data without incurring significant computational costs.
          </p>
        </div>
      </div>
    </div>

    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop has-text-centered">
    <div class="section">
      <h2 class="title is-3">Overview of SPARKE Diversity Guidance</h2>
      <img src="./static/images/figure_1.jpg">
      </img>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">SPARKE</span> significantly enhances prompt-aware diversity in text-to-image diffusion models with high computational efficiency.
      </h2>
    </div>
  </div>
</section>

<section class="hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop has-text-centered">
      <h2 class="title is-3">Qualitative Results on SOTA Diffusion Models</h2>

      <div class="swiper">
        <div class="swiper-wrapper">
          <div class="swiper-slide">
            <img src="./static/images/pixart_qualitative_sparke.jpg" class="carousel-image" />
          </div>
          <div class="swiper-slide">
            <img src="./static/images/sdxl_qualitative_sparke.jpg" class="carousel-image" />
          </div>
          <div class="swiper-slide">
            <img src="./static/images/conditional_vs_unconditional_extended_sparke.jpg" class="carousel-image" />
          </div>
        </div>

        <!-- Navigation buttons -->
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>

        <!-- Optional pagination -->
        <div class="swiper-pagination"></div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop has-text-centered">
    <div class="section">
      <h3 class="title is-3">Enhancing CFG in Class-Conditional Diffusion Models</h3>
      <img src="./static/images/qualitative_cfg_sparke.jpg">
      </img>
      <h2 class="subtitle has-text-centered">
        SPARKE improves diversity under high classifier-free guidance (CFG) in ImageNet class-conditional diffusion models.
      </h2>
    </div>
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title"><a id="bibtex">BibTeX</a></h2>
    <p>To cite this work, please use the following BibTeX entries:</p>
    <p>SPARKE Diversity Guidance:</p>
    <pre><code>@article{jalali2025sparke,
  author = {Mohammad Jalali and Haoyu Lei and Amin Gohari and Farzan Farnia},
  title = {SPARKE: Scalable Prompt-Aware Diversity Guidance in Diffusion Models via RKE Score},
  journal = {arXiv preprint arXiv:2506.10173},
  year = {2025},
  url = {https://arxiv.org/abs/2506.10173},
}</code></pre>

    <p>RKE Score:</p>
    <pre><code>@inproceedings{jalali2023rke,
      author = {Jalali, Mohammad and Li, Cheuk Ting and Farnia, Farzan},
      booktitle = {Advances in Neural Information Processing Systems},
      pages = {9931--9943},
      title = {An Information-Theoretic Evaluation of Generative Models in Learning Multi-modal Distributions},
      url = {https://openreview.net/forum?id=PdZhf6PiAb},
      volume = {36},
      year = {2023}
}</code></pre>     
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            Website adapted from the following <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
